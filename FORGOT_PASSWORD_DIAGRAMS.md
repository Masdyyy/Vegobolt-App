# ğŸ” Forgot Password - Architecture & Flow Diagram

## ğŸ“Š System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        FORGOT PASSWORD SYSTEM                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  â”‚         â”‚                  â”‚         â”‚                  â”‚
â”‚  Flutter App     â”‚ â†â”€â”€â”€â”€â”€â†’ â”‚  Node.js API     â”‚ â†â”€â”€â”€â”€â”€â†’ â”‚  MongoDB Atlas   â”‚
â”‚  (Mobile)        â”‚  HTTP   â”‚  (Express)       â”‚  Query  â”‚  (Database)      â”‚
â”‚                  â”‚         â”‚                  â”‚         â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â”‚
                                      â†“
                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                             â”‚                  â”‚
                             â”‚  Gmail SMTP      â”‚
                             â”‚  (Email Service) â”‚
                             â”‚                  â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Data Flow - Request Reset

```
User                    Flutter App              Backend API              Database              Email Service
  â”‚                          â”‚                        â”‚                       â”‚                       â”‚
  â”‚  1. Enter Email         â”‚                        â”‚                       â”‚                       â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚                        â”‚                       â”‚                       â”‚
  â”‚                          â”‚                        â”‚                       â”‚                       â”‚
  â”‚                          â”‚  2. POST /password-reset                      â”‚                       â”‚
  â”‚                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚                       â”‚                       â”‚
  â”‚                          â”‚                        â”‚                       â”‚                       â”‚
  â”‚                          â”‚                        â”‚  3. Find User         â”‚                       â”‚
  â”‚                          â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚                       â”‚
  â”‚                          â”‚                        â”‚                       â”‚                       â”‚
  â”‚                          â”‚                        â”‚  4. User Found        â”‚                       â”‚
  â”‚                          â”‚                        â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚
  â”‚                          â”‚                        â”‚                       â”‚                       â”‚
  â”‚                          â”‚                        â”‚  5. Generate Token    â”‚                       â”‚
  â”‚                          â”‚                        â”‚  6. Save Token + Expiry                       â”‚
  â”‚                          â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚                       â”‚
  â”‚                          â”‚                        â”‚                       â”‚                       â”‚
  â”‚                          â”‚                        â”‚  7. Send Reset Email  â”‚                       â”‚
  â”‚                          â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
  â”‚                          â”‚                        â”‚                       â”‚                       â”‚
  â”‚                          â”‚  8. Success Response   â”‚                       â”‚                       â”‚
  â”‚                          â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚                       â”‚
  â”‚                          â”‚                        â”‚                       â”‚                       â”‚
  â”‚  9. Show Success Msg     â”‚                        â”‚                       â”‚                       â”‚
  â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚                       â”‚                       â”‚
  â”‚                          â”‚                        â”‚                       â”‚                       â”‚
  â”‚  10. Check Email         â”‚                        â”‚                       â”‚                       â”‚
  â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚     (Reset Link)         â”‚                        â”‚                       â”‚                       â”‚
```

---

## ğŸ”„ Data Flow - Reset Password

```
User                    Email               Flutter App              Backend API              Database
  â”‚                       â”‚                      â”‚                        â”‚                       â”‚
  â”‚  1. Click Link       â”‚                      â”‚                        â”‚                       â”‚
  â”‚      in Email        â”‚                      â”‚                        â”‚                       â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚                      â”‚                        â”‚                       â”‚
  â”‚                       â”‚                      â”‚                        â”‚                       â”‚
  â”‚                       â”‚  2. Extract Token    â”‚                        â”‚                       â”‚
  â”‚                       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚                        â”‚                       â”‚
  â”‚                       â”‚                      â”‚                        â”‚                       â”‚
  â”‚  3. Enter New         â”‚                      â”‚                        â”‚                       â”‚
  â”‚     Password          â”‚                      â”‚                        â”‚                       â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚                        â”‚                       â”‚
  â”‚                       â”‚                      â”‚                        â”‚                       â”‚
  â”‚                       â”‚                      â”‚  4. POST /reset-password                      â”‚
  â”‚                       â”‚                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚                       â”‚
  â”‚                       â”‚                      â”‚                        â”‚                       â”‚
  â”‚                       â”‚                      â”‚                        â”‚  5. Validate Token   â”‚
  â”‚                       â”‚                      â”‚                        â”‚     & Check Expiry   â”‚
  â”‚                       â”‚                      â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
  â”‚                       â”‚                      â”‚                        â”‚                       â”‚
  â”‚                       â”‚                      â”‚                        â”‚  6. Token Valid      â”‚
  â”‚                       â”‚                      â”‚                        â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                       â”‚                      â”‚                        â”‚                       â”‚
  â”‚                       â”‚                      â”‚                        â”‚  7. Hash New Passwordâ”‚
  â”‚                       â”‚                      â”‚                        â”‚  8. Update Password  â”‚
  â”‚                       â”‚                      â”‚                        â”‚  9. Clear Token      â”‚
  â”‚                       â”‚                      â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
  â”‚                       â”‚                      â”‚                        â”‚                       â”‚
  â”‚                       â”‚                      â”‚  10. Success Response  â”‚                       â”‚
  â”‚                       â”‚                      â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚
  â”‚                       â”‚                      â”‚                        â”‚                       â”‚
  â”‚  11. Redirect to Login                       â”‚                        â”‚                       â”‚
  â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚                       â”‚
  â”‚                       â”‚                      â”‚                        â”‚                       â”‚
  â”‚  12. Login with       â”‚                      â”‚                        â”‚                       â”‚
  â”‚      New Password     â”‚                      â”‚                        â”‚                       â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚                       â”‚
```

---

## ğŸ—„ï¸ Database Schema

### User Model - New Fields

```javascript
{
  // ... existing fields ...
  
  // ğŸ†• Password Reset Fields
  passwordResetToken: {
    type: String,
    default: null,
    description: "Secure token for password reset"
  },
  
  passwordResetExpires: {
    type: Date,
    default: null,
    description: "Token expiration time (1 hour from generation)"
  }
}
```

### Example Document

```json
{
  "_id": "507f1f77bcf86cd799439011",
  "email": "user@example.com",
  "password": "$2a$10$abcd1234...",
  "firstName": "John",
  "lastName": "Doe",
  "passwordResetToken": "a1b2c3d4e5f6...",
  "passwordResetExpires": "2025-10-21T15:30:00.000Z",
  "createdAt": "2025-01-01T00:00:00.000Z",
  "updatedAt": "2025-10-21T14:30:00.000Z"
}
```

---

## ğŸ“§ Email Template Structure

```html
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                      â”‚
â”‚  VEGOBOLT LOGO / HEADER              â”‚
â”‚                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚
â”‚  Password Reset Request              â”‚
â”‚                                      â”‚
â”‚  Hello John Doe,                     â”‚
â”‚                                      â”‚
â”‚  We received a request to reset      â”‚
â”‚  your password...                    â”‚
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  [Reset Password Button]     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                      â”‚
â”‚  Or copy this link:                  â”‚
â”‚  https://vegobolt.../reset?token=... â”‚
â”‚                                      â”‚
â”‚  This link expires in 1 hour         â”‚
â”‚                                      â”‚
â”‚  Security Notice:                    â”‚
â”‚  If you didn't request this...       â”‚
â”‚                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Â© 2025 Vegobolt. All rights reservedâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Security Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SECURITY MEASURES                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. Token Generation
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ crypto.randomBytes(32)     â”‚
   â”‚ â†’ 64-character hex string  â”‚
   â”‚ â†’ Cryptographically secure â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. Token Storage
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Store in MongoDB           â”‚
   â”‚ + Expiration timestamp     â”‚
   â”‚ + Link to user account     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. Token Validation
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ âœ“ Token exists?            â”‚
   â”‚ âœ“ Token not expired?       â”‚
   â”‚ âœ“ Linked to valid user?    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

4. Password Hashing
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ bcrypt.hash(password, 10)  â”‚
   â”‚ â†’ Salted hash              â”‚
   â”‚ â†’ Store in database        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

5. Token Cleanup
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Clear token field          â”‚
   â”‚ Clear expiration           â”‚
   â”‚ â†’ After successful reset   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“± Flutter App Pages

```
App Pages Structure
â”‚
â”œâ”€â”€ LoginPage
â”‚   â””â”€â”€ [Forgot Password?] â”€â”€â†’ ForgotPasswordPage
â”‚
â”œâ”€â”€ ForgotPasswordPage
â”‚   â”œâ”€â”€ Email Input Field
â”‚   â”œâ”€â”€ [Continue Button]
â”‚   â””â”€â”€ â†’ Success â†’ Navigate Back to Login
â”‚
â””â”€â”€ ResetPasswordPage (Token-based)
    â”œâ”€â”€ New Password Input
    â”œâ”€â”€ Confirm Password Input
    â”œâ”€â”€ [Reset Password Button]
    â””â”€â”€ â†’ Success â†’ Navigate to Login
```

---

## ğŸ”„ State Management

```
ForgotPasswordPage State Flow
â”‚
â”œâ”€â”€ Initial State
â”‚   â”œâ”€â”€ _isLoading = false
â”‚   â”œâ”€â”€ _emailController = ""
â”‚   â””â”€â”€ Form not validated
â”‚
â”œâ”€â”€ User Enters Email
â”‚   â””â”€â”€ Validate email format
â”‚
â”œâ”€â”€ Click Continue
â”‚   â”œâ”€â”€ _isLoading = true
â”‚   â”œâ”€â”€ Call API
â”‚   â”œâ”€â”€ Wait for response
â”‚   â”‚
â”‚   â”œâ”€â”€ Success?
â”‚   â”‚   â”œâ”€â”€ _isLoading = false
â”‚   â”‚   â”œâ”€â”€ Show success message
â”‚   â”‚   â””â”€â”€ Navigate back
â”‚   â”‚
â”‚   â””â”€â”€ Error?
â”‚       â”œâ”€â”€ _isLoading = false
â”‚       â””â”€â”€ Show error message
```

---

## ğŸ¯ Component Interaction

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      COMPONENT DIAGRAM                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Flutter App
â”œâ”€â”€ Pages/
â”‚   â”œâ”€â”€ ForgotPasswordPage.dart
â”‚   â”‚   â””â”€â”€ Uses â†’ AuthService
â”‚   â””â”€â”€ ResetPasswordPage.dart
â”‚       â””â”€â”€ Uses â†’ AuthService
â”‚
â”œâ”€â”€ Services/
â”‚   â””â”€â”€ AuthService.dart
â”‚       â”œâ”€â”€ requestPasswordReset()
â”‚       â””â”€â”€ resetPassword()
â”‚           â””â”€â”€ Uses â†’ ApiConfig
â”‚
â””â”€â”€ Utils/
    â””â”€â”€ ApiConfig.dart
        â”œâ”€â”€ authPasswordReset = "/api/auth/password-reset"
        â””â”€â”€ authResetPassword = "/api/auth/reset-password"

Backend API
â”œâ”€â”€ Routes/
â”‚   â””â”€â”€ authRoutes.js
â”‚       â”œâ”€â”€ POST /password-reset â†’ authController.requestPasswordReset
â”‚       â””â”€â”€ POST /reset-password â†’ authController.resetPassword
â”‚
â”œâ”€â”€ Controllers/
â”‚   â””â”€â”€ authController.js
â”‚       â”œâ”€â”€ requestPasswordReset()
â”‚       â”‚   â””â”€â”€ Uses â†’ EmailService, User Model
â”‚       â””â”€â”€ resetPassword()
â”‚           â””â”€â”€ Uses â†’ User Model, bcrypt
â”‚
â”œâ”€â”€ Services/
â”‚   â””â”€â”€ emailService.js
â”‚       â””â”€â”€ sendPasswordResetEmail()
â”‚           â””â”€â”€ Uses â†’ nodemailer
â”‚
â””â”€â”€ Models/
    â””â”€â”€ User.js
        â”œâ”€â”€ passwordResetToken
        â””â”€â”€ passwordResetExpires
```

---

## ğŸŒ Network Communication

```
Request Format
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

POST /api/auth/password-reset
Content-Type: application/json

{
  "email": "user@example.com"
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Response Format (Success)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Status: 200 OK
Content-Type: application/json

{
  "success": true,
  "message": "If the email exists, a password reset link will be sent"
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Response Format (Error)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Status: 400/500
Content-Type: application/json

{
  "success": false,
  "message": "Error message here",
  "error": "Detailed error (dev mode only)"
}
```

---

## â±ï¸ Timeline

```
Token Lifecycle
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

00:00 â”‚ Token Generated
      â”‚ â”œâ”€ Saved to database
      â”‚ â””â”€ Email sent
      â”‚
00:30 â”‚ Token still valid âœ“
      â”‚ User can reset password
      â”‚
00:59 â”‚ Token about to expire âš ï¸
      â”‚
01:00 â”‚ Token expired âœ—
      â”‚ User must request new link
      â”‚
01:01 â”‚ Token rejected
      â”‚ "Invalid or expired token"
```

---

## ğŸ“Š Success Metrics

```
Expected Success Flow
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Request â†’ Email Sent â†’ Email Received â†’ Link Clicked â†’ 
Password Reset â†’ Token Cleared â†’ Login Success

Failure Points
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. âœ— Email not in database
   â†’ Silent success (security)

2. âœ— Email service failure
   â†’ Error: "Failed to send email"

3. âœ— Token expired
   â†’ Error: "Invalid or expired token"

4. âœ— Password validation fails
   â†’ Error: "Password must be at least 6 characters"

5. âœ— Network error
   â†’ Error: "Network error: [details]"
```

---

This visual guide helps understand the complete architecture and flow of the forgot password feature!
